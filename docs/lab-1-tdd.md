# Лабораторная работа #1: Test-Driven Development

## Цели

  1. Освоить практику разработки TDD (разработка через тестирование).
  1. Ознакомиться с практикой непрерывной интеграции.
  1. Освоить "гибкую" практику ОО дизайна, рассмотренную в лекциях "TDD",
     "Чистый код", "Рефакторинг".

## Задачи

  1. Доустановить инструменты разработки в виде IDE (рекомендуется IntelliJ IDEA
     Community Edition) и системы сборки Gradle.
  1. Разработать Java-компонент с основной логикой приложения согласно практике
     TDD. Классы должны быть "грамотно" спроектированы, должны выполняться
     рекомендации из лекции "Чистый код".
  1. Прислать результаты в виде пулл-реквеста, и добиться прохождения всех
     проверок на системе непрерывной интеграции Travis CI.

## Типичные ошибки

  1. Написание кода вперед тестов. __Следует строго следовать TDD__, иначе это
     будет сразу видно. В таком случае лабу придется переделывать.
  1. Не нужно делать коммиты файлов с бинарными сборками и других временных
     файлов от IDE.

## Детальные инструкции

### Первичная настройка

  1. Просьба следовать процессу [GitHub Flow][github-flow]. Это подразумевает,
     что разработку вы ведете в отдельной ветке Git. Просьба создать ветку, дав
     ей содержательное имя, например `lab1-tdd-triangle`. Кроме того, если к
     вашем коду будут поступать замечания, то просьба не создавать новые ветки и
     пулл-реквесты, и использовать те же самые. Так, при `git push` коммитов в
     ветку `lab1-tdd-triangle` на вашем форке обновится и пулл-реквест.
  1. Первым делом полезно обновить коды из центрального репозитория
     ([upstream ][git-pull]). Когда вы скачаете коды и сделаете их `merge` в
     свой `master`, можно будет создавать ветку `lab1-tdd-triangle` и продолжать
     в ней работу. Вот примерные команды, которые вы должны использовать:

        $ cd agile-course-practice
        $ git fetch upstream
        $ git checkout master
        $ git rebase upstream/master
        $ git checkout -b lab1-tdd-triangle

  1. Затем следует установить систему сборки [Gradle][gradle], и добавить путь
     до бинарника в `PATH`. Теперь можно попробовать собрать уже имеющиеся
     проекты (например `tddkata`, который был продемонстрирован на лекции), и
     прогнать тесты. Для этого перейдите в консоли в папку `code` и выполните
     команду `gradle check`. Вы должны увидеть как строятся и прогоняются тесты.
     __Крайне полезно знать про этот режим__, поскольку Travis запускает тесты
     аналогичным образом. Поэтому если ваш пулл-реквест будет [красным][agile-travis],
     то вы будете в состоянии воспроизвести проблему у себя локально.

        $ gradle check

  1. Теперь нужно установить IDE и попробовать импортировать наш проект в
     директории `code`. Нужно запустить все тесты и убедиться, что они проходят.
     - Если вы планируете использовать IntelliJ IDEA (рекомендуется), то она
       автоматически "понимает" проекты Gradle. Однако, предлагается не
       открывать проект в IDEA, а сперва сгенерировать проект следующей
       командой:

        $ gradle idea

     - Аналогично, если вы планируете использовать Eclipse, прежде чем
       импортировать, вам предстоит сгенерировать Eclipse-проект. Для этого
       снова перейдите в консоли в папку `code` и выполните команду
       `gradle eclipse`. В результате в каждой подпапке появится проект Eclipse,
       который теперь можно импортировать.

## Выполнение лабораторной

  1. Далее вы можете начинать работу над своим проектом. Для простоты я бы
     предложил скопировать проект `kornyakov-kirill-lab1`, и переиспользовать
     его структуру, переименовав все под свою лабораторную. Конечно, все Java-
     файлы придется удалить и написать заново. Скопированный проект можно
     импортировать в IDE и собственно приступить к разработке своего компонента.
     __Внимание:__ просьба все свои лабораторные выполнять в той же директории
     со своим именем, развивая и наращивая проект. Папки с примерами с
     суффиксами (вида `kirill-kornyakov-lab1`) создаются лишь для того, чтобы вы
     видели разницу между лабораторными. Вы же должны работать в одной папке.
  1. Свой подпроект необходимо добавить в общий проект. Для этого нужно обновить
     общий файл с перечислением подпроектов, располагающийся по следующему пути:
     `code/settings.gradle`. Найдите там комментарий со своей фамилией, и
     вставьте этом этапе нужно будет обновить лишь первые две строки в вашей
     секции (подобно тому как сделано в проекте у Антона и в проекте примере).
  1. Собственно далее вы должны разработать свой класс, решающий поставленную
     задачу, согласно практике TDD.
     - __Настоятельно рекомендуется__ соблюдать все рекомендации практики:
       создание теста до кода, маленькие итерации (думаете больше 5 минут -
       пишите вспомогательный класс), периодический рефакторинг кода и тестов.
     - __На каждый метод у вас должно в среднем не менее 3 тестов__, пара smoke
       тестов (просто на корректную работу), затем граничные значения и
       неадекватные/недопустимые аргументы.
     - Кроме того, огромная просьба следить за чистотой кода, понятностью имен и
       следованию [Java-соглашениям программирования](http://www.oracle.com/tech
       network/java/codeconv-138413.html).

## Интеграция

  1. Когда все будет готово, нужно будет прислать пулл-реквест и убедиться, что
     он [зеленый][agile-travis]. Если это не так, просьба самостоятельно
     разрешить все проблемы. Код будет рецензироваться только если пулл-реквест
     проходит все тесты. Среди прочего, автоматически будет проверяться стиль
     кодирования.
  1. Когда ваш pull request станет зеленым, начинается фаза code review. Просьба
     своевременно устранять полученные замечания, и желательно это делать в той
     же ветке и в том же пулл-реквесте. Когда все замечания будут устранены
     (чаще всего они на чистоту кода), лабораторная будет зачтена. __Если тестов
     будет мало, их придется писать, пока их не станет по ~3 штуки на каждый
     публичный метод.__ Поэтому лучше сразу пишите по TDD.

<!-- LINKS -->

[github-flow]: http://scottchacon.com/2011/08/31/github-flow.html
[git-pull]: https://groups.google.com/d/msg/devtools-course/V8rtlLrCXc4/k7vx6BxnqR4J
[gradle]: http://www.gradle.org/downloads
[agile-travis]: https://travis-ci.org/UNN-VMK-Software/agile-course-practice/pull_requests
